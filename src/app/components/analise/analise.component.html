<app-top-bar titulo="Análise"></app-top-bar>

<app-select-planilha></app-select-planilha>

<div class="table-container">

    <table mat-table [dataSource]="datasource" class="mat-elevation-z8" matSort>

        <ng-container matColumnDef="data">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Data</th>
            <td mat-cell *matCellDef="let item">{{item.data | date:'dd/MM'}} </td>
        </ng-container>

        <ng-container matColumnDef="banco">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Banco</th>
            <td mat-cell *matCellDef="let item"> {{item.banco}} </td>
        </ng-container>

        <ng-container matColumnDef="categoria">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Categoria</th>
            <td mat-cell *matCellDef="let item"> {{item.categoria}} </td>
        </ng-container>

        <ng-container matColumnDef="descricao">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Descrição</th>
            <td mat-cell *matCellDef="let item"> {{item.descricao}} </td>
        </ng-container>

        <ng-container matColumnDef="valor">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Valor</th>
            <td mat-cell *matCellDef="let item" style="text-align: right;"
                [ngStyle]="{'color':item.valor < 0 ? 'red' : 'black' }"> {{item.valor | number: '1.2-2'}} </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="colunas"></tr>
        <tr mat-row *matRowDef="let row; columns: colunas;"></tr>
    </table>
</div>

<div *ngIf="pie.columns.length > 0">
    <google-chart #chart [type]="pie.type" [columns]="pie.columns" [data]="pie.datasource" [options]="pie.options"
        [width]="pie.width" [height]="pie.height">
    </google-chart>
</div>